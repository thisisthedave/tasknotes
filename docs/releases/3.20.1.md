# TaskNotes 3.20.1

## New Features

### Enhanced View Organization and Visual Feedback

**Saved View Headings with Completion Counts** - Added visible filter headings across all views (Task List, Subtask Widget, and Agenda) that display the current saved view name and completion statistics in "completed / total" format. Shows "All" when no saved view is active. Headings update immediately on filter changes and persist correctly when switching tabs or reloading. *Contributed by @renatomen*

**Consistent Group Count Badges** - Standardized completion count display across all group headers in Task List, Subtask Widget, and Agenda views using unified "completed / total" format. Removed redundant bracketed counts for cleaner presentation. *Contributed by @renatomen*

**Collapsible Agenda Date Groups** - Added collapsible date headers to Agenda view with persistent state management. Date sections can be collapsed individually or controlled via "Expand All" / "Collapse All" buttons that are always visible in the FilterBar. Collapsed state is preserved between sessions using ViewStateManager. *Contributed by @renatomen*

### Improved User Interface

**Reorganized Task Context Menu** - Enhanced context menu organization by replacing individual buttons with logical submenus for status, priority, dates, recurrence, and reminders. Applied user-configured colors to main menu icons while maintaining all existing functionality. 

## Bug Fixes

### Calendar Integration Fixes

**Outlook Calendar 500 Errors** - Fixed Microsoft Outlook ICS endpoint failures by updating User-Agent header from 'TaskNotes-Plugin/1.0' to browser-compatible string and adding Accept-Language header. Improved error handling with specific guidance for Outlook 500 errors. *Fixes issue #458 reported by @girisumit and @heinzochsner*

**Recurring Tasks Date Display** - Fixed timezone-dependent bug where recurring tasks appeared one day ahead or behind their actual due date in Agenda View. Replaced manual UTC date construction with parseDateToUTC() following UTC Anchor principle from development guidelines. Added regression test for consistent date handling. *Fixes issue #439 reported by @brianarn and @jpmoo*

### Task Management Fixes  

**Project Suggestions Crash Prevention** - Fixed crash in Task Creation modal when typing "+" to add projects inline, caused by non-string title values in frontmatter. Added title normalization (arrays join with ", ", numbers/booleans stringify, objects become empty strings) and defensive guards in suggestion filtering. Particularly important for large vaults with heterogeneous frontmatter. *Contributed by @renatomen*

## Documentation Updates

- Added screenshots demonstrating saved view headings and completion counts for Task List and Subtask Widget
- Created demo GIF showing Agenda view collapsible groups with Expand/Collapse All functionality  
- Updated view documentation with new visual features
- Enhanced inline task documentation for Subtask Widget improvements

*Contributed by @renatomen*

## Contributors

Special recognition goes to **@renatomen** for the substantial contributions that form the core of this release, including the saved view headings system, consistent count badges, and collapsible Agenda functionality.

Thanks to the following community members for their bug reports and feedback:

- **@girisumit and @heinzochsner** - Reported Outlook calendar integration issues
- **@brianarn and @jpmoo** - Identified recurring tasks date display bug with detailed reproduction steps
